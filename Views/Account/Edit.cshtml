@model Reconova.ViewModels.Users.EditUserViewModel
@{
    ViewData["Title"] = "Edit Account";
}

@section Styles {
    <link rel="stylesheet" href="~/css/editProfile.css" />
}

<div class="edit-form-container">
    <h2>Edit Account</h2>

    <div class="cover-photo-container">
        <img src="@Url.Content(Model.CoverPhotoPath ?? "~/images/account-bg.jpg")" alt="Cover Photo" class="cover-photo" />
        <div class="profile-photo-wrapper">
            <img src="@Url.Content(Model.ProfilePhotoPath ?? "~/images/account-bg.jpg")" alt="Profile Photo" class="profile-photo" />
        </div>
    </div>

    <form asp-action="Edit" method="post" enctype="multipart/form-data">
        <input type="hidden" asp-for="Id" />

        <div class="mb-3">
            <label asp-for="FirstName" class="form-label"></label>
            <input asp-for="FirstName" class="form-control" required/>
            <span asp-validation-for="FirstName" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="LastName" class="form-label"></label>
            <input asp-for="LastName" class="form-control" required />
            <span asp-validation-for="LastName" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="Email" class="form-label"></label>
            <input asp-for="Email" class="form-control" required />
            <span asp-validation-for="Email" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="PhoneNumber" class="form-label"></label>
            <input asp-for="PhoneNumber" class="form-control" />
            <span asp-validation-for="PhoneNumber" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="BirthDate" class="form-label"></label>
            <input asp-for="BirthDate" class="form-control" type="date" />
            <span asp-validation-for="BirthDate" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="Education" class="form-label"></label>
            <input asp-for="Education" class="form-control"/>
            <span asp-validation-for="Education" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="Header" class="form-label"></label>
            <input asp-for="Header" class="form-control"/>
            <span asp-validation-for="Header" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="Bio" class="form-label"></label>
            <textarea asp-for="Bio" class="form-control" rows="3"></textarea>
            <span asp-validation-for="Bio" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="Country" class="form-label"></label>
            <input asp-for="Country" class="form-control" />
            <span asp-validation-for="Country" class="text-danger"></span>
        </div>


        <!--
        <div class="mb-3 text-center">
            <label class="form-label">Current Profile Photo</label><br />
            <img src="@Model.ProfilePhotoPath" alt="Profile Photo" class="profile-photo-preview" />
                </div>
        -->

        <div class="mb-3">
            <label asp-for="ProfilePhoto" class="form-label"></label>
            <input asp-for="ProfilePhoto" type="file" class="form-control" />
            <span asp-validation-for="ProfilePhoto" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="CoverPhoto" class="form-label"></label>
            <input asp-for="CoverPhoto" type="file" class="form-control" />
            <span asp-validation-for="CoverPhoto" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label class="form-label">Skills</label>
            <div id="skills-container">
                @for (int i = 0; i < Model.Skills.Count; i++)
                {
                    <div class="input-group mb-2 skill-input">
                        <input type="hidden" name="Skills[@i].Id" value="@Model.Skills[i].Id" />
                        <input type="text" name="Skills[@i].Name" value="@Model.Skills[i].Name" class="form-control" />
                        <button type="button" class="btn btn-danger remove-skill">X</button>
                    </div>
                }
            </div>
            <button type="button" id="add-skill" class="btn btn-outline-secondary btn-sm">+ Add Skill</button>
        </div>

        <div class="text-center">
            <a class="btn btn-secondary" asp-action="Profile">Back To Profile</a>
            <button type="submit" class="btn btn-blue">Save Changes</button>
        </div>
    </form>
</div>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")

    <script>
        document.getElementById('add-skill').addEventListener('click', function () {
            const container = document.getElementById('skills-container');
            const index = container.querySelectorAll('.skill-input').length;

            const div = document.createElement('div');
            div.className = 'input-group mb-2 skill-input';
            div.innerHTML = `
                        <input type="hidden" name="Skills[${index}].Id" value="0" />
                        <input type="text" name="Skills[${index}].Name" class="form-control" />
                        <button type="button" class="btn btn-danger remove-skill">X</button>
                    `;
            container.appendChild(div);
        });

        document.addEventListener('click', function (e) {
            if (e.target.classList.contains('remove-skill')) {
                e.target.closest('.skill-input').remove();
            }
        });
    </script>
}
