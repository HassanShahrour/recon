@using Reconova.Core.Utilities
@using Reconova.Data

@model Reconova.Data.Models.User
@inject UserUtility userUtility
@inject ReconovaDbContext db

@{
    var currentUserId = await userUtility.GetLoggedInUserId();
    bool isFollowing = db.UserFollowing
        .Any(f => f.FollowerId == currentUserId.ToString() && f.FolloweeId == Model.Id);
}

<div class="col-md-4 col-lg-3">
    <div class="user-card">
      
        <img src="@Url.Content(Model.CoverPhotoPath ?? "~/images/account-bg.jpg")" alt="Cover" class="cover-photo" />

       
        <img src="@Url.Content(Model.ProfilePhotoPath ?? "~/images/account-bg.jpg")" alt="Profile" class="profile-photo" />

        <div class="card-body">
          
            <a asp-controller="Network" asp-action="ViewUser" asp-route-id="@Model.Id" class="card-link-wrapper">
                <h5>@Model.FirstName @Model.LastName</h5>
                <p class="text-muted">@(Model.Header ?? Model.Email)</p>
            </a>

            @if (currentUserId.ToString() != Model.Id)
            {
                <button class="follow-btn btn @(isFollowing ? "btn-danger" : "btn-blue")"
                        data-user-id="@Model.Id"
                        data-is-following="@isFollowing.ToString().ToLower()">
                    @(isFollowing ? "Unfollow" : "Follow")
                </button>

            }

        </div>
    </div>
</div>



